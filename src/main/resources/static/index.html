<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Escape room base by Daan Streng</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>
    <style>
        .collapsible-body li>a{
            font-weight:400;
            margin-left:15px;
        }
        header, main, footer {
            padding-left: 300px;
        }
        iframe{
            width:100%;
            height:100%;
            border:none;
            margin:0;
            padding:0;
        }
        html, body{
            width:100%;
            height:100%;
        }
        main{
            height: calc(100% - 126px);
        }
        iframe{
            width:100%;
            height:100%;
        }
    </style>
</head>
<body>
<header>
    <nav class="top-nav center" style="height:122px;line-height:122px; background-color:#3c3c3c">
        <div class="container" id="refreshClickHere">
            <div class="nav-wrapper"><a style="font-size:150%" class="page-title">Escape Room XL Online mega super turbo</a></div>
        </div>
    </nav>
    <div class="container"><a style="position: absolute;line-height:122px;top:0px;font-size:33px" href="#" data-activates="slied-out" class="button-collapse top-nav full hide-on-large-only">
        <i style="line-height:122px;color:white;font-size:33px" class="material-icons">menu</i></a></div>

</header>
<ul id="slide-out" class="side-nav fixed">
    <li><div class="userView">
        <div class="background" style="background-image:url('/img/escape.jpg');background-size:cover;">
        </div>
        <a href="#!user"><img class="" style="width:64px" src="/img/logo.png"></a>
        <a href="#!name"><span class="white-text name">Escape room</span></a>
        <a ><span class="white-text email"></span></a>
    </div></li>
    <li><a  href="/">Home</a></li>

    <li class="no-padding">
        <ul class="collapsible collapsible-accordion">
            <li>
                <a class="collapsible-header" style="padding-left:32px;">Player</a>
                <div class="collapsible-body" style="font-weight:300">
                    <ul>
                        <li class=""><a class="iframe-fill-link" href="/player/view/create">Create Account</a></li>
                        <li class=""><a  class="iframe-fill-link" href="/player/">Login</a></li>
                    </ul>
                </div>
            </li>
        </ul>
    </li>

    <li class="no-padding">
        <ul class="collapsible collapsible-accordion">
            <li>
                <a class="collapsible-header" style="padding-left:32px;">Room</a>
                <div class="collapsible-body" style="font-weight:300">
                    <ul>
                        <li class=""><a id="testRoomProxyButton">Test Room Proxy</a></li>
                        <li class=""><a  class="iframe-fill-link" href="/rooms.html" >View All Rooms</a></li>
                        <li class=""><a class="iframe-fill-link" href="/mainroom/view/register">Register a room</a></li>
                    </ul>
                </div>
            </li>
        </ul>
    </li>


</ul>
<main>
    <script>
        var content_start_loading = function() {
            //  indicator.style.display = 'block';
            $("#proxyFrame").hide();
            $("#loader").show();
        };

        var content_finished_loading = function(iframe) {
            //  indicator.style.display = 'none';
            // inject the start loading handler when content finished loading
            iframe.contentWindow.onunload = content_start_loading;
            console.log("done");
            $("#proxyFrame").show();
            $("#loader").hide();
        };
    </script>
<iframe id="proxyFrame" onload="content_finished_loading(this)"></iframe>

    <div id="loader" style="display:none;width:100%;height:100%;text-align:center;position:relative">
        <div class="preloader-wrapper big active" style="margin-top:25%;position:relative">
            <div class="spinner-layer spinner-blue">
                <div class="circle-clipper left">
                    <div class="circle"></div>
                </div><div class="gap-patch">
                <div class="circle"></div>
            </div><div class="circle-clipper right">
                <div class="circle"></div>
            </div>
            </div>

            <div class="spinner-layer spinner-red">
                <div class="circle-clipper left">
                    <div class="circle"></div>
                </div><div class="gap-patch">
                <div class="circle"></div>
            </div><div class="circle-clipper right">
                <div class="circle"></div>
            </div>
            </div>

            <div class="spinner-layer spinner-yellow">
                <div class="circle-clipper left">
                    <div class="circle"></div>
                </div><div class="gap-patch">
                <div class="circle"></div>
            </div><div class="circle-clipper right">
                <div class="circle"></div>
            </div>
            </div>

            <div class="spinner-layer spinner-green">
                <div class="circle-clipper left">
                    <div class="circle"></div>
                </div><div class="gap-patch">
                <div class="circle"></div>
            </div><div class="circle-clipper right">
                <div class="circle"></div>
            </div>
            </div>
        </div>
    </div>

</main>
<script>
    $(document).ready(function(){
        $("#testRoomProxyButton").click(function(){
            var uuid = prompt("room uuid");
            $("#proxyFrame").hide();
            $("#loader").show();
            $("#proxyFrame").attr("src","/room/"+uuid+"/view/test.html");
        });
        $(".iframe-fill-link").click(function(e){
            e.preventDefault();
            var href = $(this).attr("href");
            $("#proxyFrame").attr("src",href);
        });
        $("#refreshClickHere").click(function(){
            var iframe = document.getElementById("proxyFrame");
            iframe.contentDocument.location.reload(true);
        })


    });

  //  var indicator = document.querySelector('.loading-indicator');


</script>
</body>
</html>